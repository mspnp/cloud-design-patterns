# Claim-check cloud pattern examples

This folder contains several examples illustrating the use of the [Claim-Check design pattern](https://learn.microsoft.com/azure/architecture/patterns/claim-check) with various Azure services.

> All the examples in this folder use [`DefaultAzureCredential`](https://learn.microsoft.com/dotnet/azure/sdk/authentication/#defaultazurecredential) to authenticate when accessing Azure resources. The Bicep script on each sample assigns the necessary RBAC (Role-Based Access Control) permissions to an account principal, which is provided as a parameter, during deployment.

## [Automatic claim check token generation, Azure Queue Storage as messaging system](./code-samples/sample-1/)

> Technologies used: Azure Blob Storage, Azure Event Grid, Azure Functions, Azure Blob Queue, .NET

This example uses Azure Blob Storage to store the payload, but any service that supports [Event Grid](https://azure.microsoft.com/services/event-grid/) integration can be used. A client application uploads the payload to Azure Blob Store and Event Grid automatically generates an event, with a reference to the blob, that can be used as a claim check token. The event is forwarded to an Azure Queue Storage queue from where it can be retrieved by the consumer sample app.

This approach allows a client application to poll the queue, get the message, extract the reference to the payload blob, and use it to download the payload directly from Azure Blob Storage. Azure Functions can also consume the Event Grid message directly.

## [Automatic claim check token generation, Event Hubs as messaging system](./code-samples/sample-2/)

> Technologies used: Azure Blob Storage, Azure Event Grid, Azure Event Hubs, .NET

Like in the previous example, a reference message is automatically generated by Event Grid when a payload is uploaded to Azure Blob Storage. In this sample, Event Hubs is used as the messaging system.

## [Automatic claim check token generation, Service Bus as messaging system](./code-samples/sample-3/)

> Technologies used: Azure Blob Storage, Azure Event Grid, Azure Service Bus, Azure Functions, .NET

Like in the previous two examples, a reference message is automatically generated by Event Grid when a payload is uploaded to Azure Blob Storage. In this sample, Service Bus is used as the messaging system.

## [Manual claim check token generation, Kafka API-enabled Event Hubs as messaging system](./code-samples/sample-4/)

> Technologies used: Azure Blob Storage, Azure Event Hubs with Kafka Api, Azure Functions, .NET

In this example the client application uploads the payload to Azure Blob Storage and manually generates the message to be used as a claim check token, which is sent via Event Hubs.

This example uses [Event Hubs with Kafka enabled](https://learn.microsoft.com/azure/event-hubs/event-hubs-create-kafka-enabled), to demonstrate the ease of using other Azure services like Azure Blob Storage, Azure functions etc. with a different messaging protocol like Kafka.

## Contributions

Please see our [Contributor guide](../CONTRIBUTING.md).

This project has adopted the [Microsoft Open Source Code of Conduct](https://opensource.microsoft.com/codeofconduct/). For more information see the [Code of Conduct FAQ](https://opensource.microsoft.com/codeofconduct/faq/) or contact <opencode@microsoft.com> with any additional questions or comments.

With :heart: from Azure patterns & practices, [Azure Architecture Center](https://azure.com/architecture).